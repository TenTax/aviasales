(this["webpackJsonpaviasales-test-task"]=this["webpackJsonpaviasales-test-task"]||[]).push([[0],{50:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(1),s=n(21),i=n.n(s),c=n(9),o=n(10),l=n(7),u=n(8),d=n(24),h=n(23),f=n(5),j=n.n(f),b=n(12),v=n(22),O=n.n(v),p=function(){function e(){Object(l.a)(this,e),this._baseURL="https://front-test.beta.aviasales.ru"}return Object(u.a)(e,[{key:"getResourse",value:function(){var e=Object(b.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get("".concat(this._baseURL).concat(t));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllTickets",value:function(){var e=Object(b.a)(j.a.mark((function e(){var t,n,r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getResourse("/search");case 2:return t=e.sent,n=t.searchId,e.next=6,this.getResourse("/tickets?searchId=".concat(n));case 6:return r=e.sent,a=r.tickets,e.abrupt("return",this._transformAllTickets(a));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_dateTransform",value:function(e,t){var n=new Date(Date.parse(e)+60*parseInt(t)*1e3).toLocaleTimeString();return n.substring(0,n.lastIndexOf(":"))}},{key:"_durationTransform",value:function(e){return"".concat(Math.floor(e/60),"\u0447 ").concat(Math.ceil(e%60),"\u043c")}},{key:"_segmentTransform",value:function(e){var t=e.origin,n=e.destination,r=e.date,a=e.duration,s=e.stops;return{origin:t,destination:n,departure:this._dateTransform(r,0),arrival:this._dateTransform(r,a),duration:this._durationTransform(a),stopsCount:s.length,stopsNames:s.join(", ")}}},{key:"_transformAllTickets",value:function(e){var t=this;return e.map((function(e,n){var r=e.price,a=e.carrier,s=Object(c.a)(e.segments,2),i=s[0],o=s[1];return{id:n,price:r.toLocaleString(),carrier:a,segments:[t._segmentTransform(i),t._segmentTransform(o)],duration:i.duration+o.duration}}))}}]),e}(),g=(n(50),function(){return Object(r.jsx)("div",{className:"ErrorMessage",children:Object(r.jsx)("div",{className:"ErrorMessageContent",children:"\u0423\u043f\u0441! \u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430, \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443, \u0438\u043b\u0438 \u0437\u0430\u0439\u0434\u0438\u0442\u0435 \u043f\u043e\u0437\u0436\u0435"})})}),x=(n(51),function(){return Object(r.jsx)("div",{className:"Preloader",children:Object(r.jsx)("div",{className:"PreloaderSpinner"})})}),m=(n(52),function(e){var t=e.label,n=e.id,a=e.handlerFilterPanel,s=e.checked,i=e.filter;return Object(r.jsxs)("label",{htmlFor:n,className:"FilterPanelLabel",children:[Object(r.jsx)("input",{id:n,onChange:function(){return a(i)},checked:s,type:"checkbox"})," ",t]})}),k=(n(53),function(e){var t=e.handlerFilterPanel,n=e.filters;return Object(r.jsxs)("div",{className:"FilterPanel",children:[Object(r.jsx)("div",{className:"FilterPanelTitle",children:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"}),Object(r.jsx)(m,{id:"allTickets",handlerFilterPanel:t,checked:4===n.length,label:"\u0412\u0441\u0435"}),Object(r.jsx)(m,{id:"withoutTransfers",handlerFilterPanel:t,checked:-1!==n.indexOf(0),label:"\u0411\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a",filter:0}),Object(r.jsx)(m,{id:"oneTransfer",handlerFilterPanel:t,checked:-1!==n.indexOf(1),label:"\u041e\u0434\u043d\u0430 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430",filter:1}),Object(r.jsx)(m,{id:"twoTransfers",handlerFilterPanel:t,checked:-1!==n.indexOf(2),label:"\u0414\u0432\u0435 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438",filter:2}),Object(r.jsx)(m,{id:"threeTransfers",handlerFilterPanel:t,checked:-1!==n.indexOf(3),label:"\u0422\u0440\u0438 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438",filter:3})]})}),T=n(4),P=(n(54),function(e){var t=e.label,n=e.sort,a=e.sortable,s=e.handlerSortPanel,i=n===a?"active":"";return Object(r.jsx)("button",{className:"ButtonSort ".concat(i),onClick:function(){return s(a)},children:t})}),N=(n(55),function(e){return Object(r.jsxs)("div",{className:"SortPanel",children:[Object(r.jsx)(P,Object(T.a)({label:"\u0421\u0430\u043c\u044b\u0439 \u0434\u0435\u0448\u0435\u0432\u044b\u0439",sortable:"price"},e)),Object(r.jsx)(P,Object(T.a)({label:"\u0421\u0430\u043c\u044b\u0439 \u0431\u044b\u0441\u0442\u0440\u044b\u0439",sortable:"duration"},e))]})}),y=n(25),F=(n(56),function(e){var t=e.header,n=e.content;return Object(r.jsxs)("div",{className:"TicketInfo",children:[Object(r.jsx)("div",{className:"TicketInfoHeader",children:t}),Object(r.jsx)("div",{className:"TicketInfoContent",children:n})]})}),L=(n(57),function(e){var t=e.price,n=e.carrier,s=e.segments.map((function(e,t){return Object(r.jsxs)(a.Fragment,{children:[Object(r.jsx)(F,{header:"".concat(e.origin," - ").concat(e.destination),content:"".concat(e.departure," - ").concat(e.arrival)}),Object(r.jsx)(F,{header:"\u0412 \u043f\u0443\u0442\u0438",content:e.duration}),Object(r.jsx)(F,{header:"\u041f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a ".concat(e.stopsCount),content:e.stopsNames})]},t)}));return Object(r.jsxs)("div",{className:"Ticket",children:[Object(r.jsxs)("div",{className:"TicketPrice",children:[t," \u0420"]}),Object(r.jsx)("img",{className:"TicketLogo",src:"//pics.avs.io/99/36/".concat(n,".png"),alt:""}),s]})}),S=(n(58),function(e){var t=e.tickets.map((function(e){var t=e.id,n=Object(y.a)(e,["id"]);return Object(r.jsx)(L,Object(T.a)({},n),t)}));return Object(r.jsx)("div",{className:"TicketList",children:t})}),M=(n(59),function(e){var t=e.handlerLoadMore;return Object(r.jsx)("button",{onClick:t,type:"button",className:"ButtonLoadMore",children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0435\u0449\u0435"})}),_=(n(60),n.p+"static/media/Logo.84685afa.svg"),w=function(){return Object(r.jsx)("div",{className:"Logo",children:Object(r.jsx)("img",{className:"LogoImage",src:_,alt:"logo aviasales"})})},C=(n(61),function(e){var t=e.handlerLoadMore,n=e.handlerSortPanel,a=e.handlerFilterPanel,s=e.sort,i=e.tickets,c=e.filters;return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsx)(w,{}),Object(r.jsxs)("div",{className:"AppContainer",children:[Object(r.jsx)(k,{filters:c,handlerFilterPanel:a}),Object(r.jsxs)("div",{children:[Object(r.jsx)(N,{sort:s,handlerSortPanel:n}),Object(r.jsx)(S,{tickets:i}),Object(r.jsx)(M,{handlerLoadMore:t})]})]})]})}),A=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).serviceApi=new p,e.state={tickets:[],error:!1,loading:!0,page:1,sort:"price",filters:[]},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.serviceApi.getAllTickets().then((function(t){e.setState({tickets:t,loading:!1})})).catch((function(t){console.log(t.message),e.setState({error:!0,loading:!1})}))}},{key:"handlerSortPanel",value:function(e){this.setState({sort:e,page:1})}},{key:"handlerLoadMore",value:function(){this.setState((function(e){return{page:e.page+1}}))}},{key:"handlerFilterPanel",value:function(e){this.setState((function(t){var n=t.filters,r=n.indexOf(e);return{filters:void 0===e?4!==n.length?[0,1,2,3]:[]:-1!==r?[].concat(Object(o.a)(n.slice(0,r)),Object(o.a)(n.slice(r+1))):[].concat(Object(o.a)(n),[e])}}))}},{key:"filtering",value:function(e,t){return 4!==t.length&&t.length?e.filter((function(e){var n=Object(c.a)(e.segments,2),r=n[0],a=n[1];return-1!==t.indexOf(r.stopsCount)&&-1!==t.indexOf(a.stopsCount)})):e}},{key:"sorting",value:function(e,t){return e.sort((function(e,n){return e[t]>n[t]?1:e[t]===n[t]?0:e[t]<n[t]?-1:null}))}},{key:"paginate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.slice(0,10*t)}},{key:"render",value:function(){var e=this.state,t=e.tickets,n=e.error,a=e.loading,s=e.page,i=e.sort,c=e.filters,o=this.filtering(t,c),l=this.sorting(o,i),u=this.paginate(l,s);return a?Object(r.jsx)(x,{}):n?Object(r.jsx)(g,{}):Object(r.jsx)(C,{tickets:u,sort:i,filters:c,handlerLoadMore:this.handlerLoadMore.bind(this),handlerSortPanel:this.handlerSortPanel.bind(this),handlerFilterPanel:this.handlerFilterPanel.bind(this)})}}]),n}(a.Component);i.a.render(Object(r.jsx)(A,{}),document.getElementById("root"))}},[[62,1,2]]]);
//# sourceMappingURL=main.e9dc0bc0.chunk.js.map