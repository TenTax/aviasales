(this["webpackJsonpaviasales-test-task"]=this["webpackJsonpaviasales-test-task"]||[]).push([[0],{55:function(t,e,c){},56:function(t,e,c){},57:function(t,e,c){},58:function(t,e,c){},59:function(t,e,c){},60:function(t,e,c){},61:function(t,e,c){},62:function(t,e,c){"use strict";c.r(e);var s=c(0),i=c(1),n=c.n(i),a=c(10),r=c.n(a),l=c(4),o=c(5),j=c(6),u=c(8),d=c(7),b=c(15),p=c.n(b),h="GET_TICKETS_SUCCESS",O="GET_TICKETS_FAILED",f="NEXT_PAGE",_="SORTING",m="FETCHING",x="SET_FILTER",v=(c(55),function(t){Object(u.a)(c,t);var e=Object(d.a)(c);function c(){return Object(o.a)(this,c),e.apply(this,arguments)}return Object(j.a)(c,[{key:"render",value:function(){var t=this.props.setFilter,e=function(e){t(e.target.getAttribute("data-filter"))};return Object(s.jsxs)("div",{className:"filter",children:[Object(s.jsx)("h2",{className:"filter__title",children:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"}),Object(s.jsxs)("label",{className:"filter__label",htmlFor:"stopsWithout",children:[Object(s.jsx)("input",{className:"filter__checkbox",onChange:e,type:"checkbox",id:"stopsWithout","data-filter":"0"}),Object(s.jsx)("span",{children:"\u0411\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"})]}),Object(s.jsxs)("label",{className:"filter__label",htmlFor:"oneStop",children:[Object(s.jsx)("input",{className:"filter__checkbox",onChange:e,type:"checkbox",id:"oneStop","data-filter":"1"}),Object(s.jsx)("span",{children:"1 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430"})]}),Object(s.jsxs)("label",{className:"filter__label",htmlFor:"twoStops",children:[Object(s.jsx)("input",{className:"filter__checkbox",onChange:e,type:"checkbox",id:"twoStops","data-filter":"2"}),Object(s.jsx)("span",{children:"2 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438"})]}),Object(s.jsxs)("label",{className:"filter__label",htmlFor:"threeStops",children:[Object(s.jsx)("input",{className:"filter__checkbox",onChange:e,type:"checkbox",id:"threeStops","data-filter":"3"}),Object(s.jsx)("span",{children:"3 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438"})]})]})}}]),c}(n.a.Component)),k={setFilter:function(t){return function(e){e({type:x,filter:t})}}},g=Object(l.b)((function(t){return{}}),k)(v),N=c.p+"static/media/favicon.84685afa.svg",C=(c(56),function(){return Object(s.jsx)("div",{className:"logo",children:Object(s.jsx)("img",{className:"logo__img",src:N,alt:"logo"})})}),y=(c(57),function(t){var e=t.ticket,c=e.price,i=e.carrier,n=e.segments,a=function(t,e){var c=new Date(Date.parse(t)+60*parseInt(e)*1e3).toLocaleTimeString();return c.substring(0,c.lastIndexOf(":"))},r=function(t){return"".concat(Math.floor(t/60),"\u0447 ").concat(Math.ceil(t%60),"\u043c")},l=function(t){return t.length?"\u041f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a "+t.length:"\u0411\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"};return Object(s.jsxs)("div",{className:"ticket",children:[Object(s.jsxs)("div",{className:"ticket__row ticket__row--mb20",children:[Object(s.jsx)("div",{className:"ticket__col",children:Object(s.jsxs)("div",{className:"ticket__price",children:[c.toLocaleString()," \u0420"]})}),Object(s.jsx)("div",{className:"ticket__col"}),Object(s.jsx)("div",{className:"ticket__col",children:Object(s.jsx)("img",{className:"ticket__logo",src:"//pics.avs.io/99/36/".concat(i,".png"),alt:""})})]}),Object(s.jsxs)("div",{className:"ticket__row ticket__row--mb10",children:[Object(s.jsxs)("div",{className:"ticket__col",children:[Object(s.jsxs)("div",{className:"ticket__title",children:[n[0].origin," - ",n[0].destination]}),Object(s.jsxs)("div",{className:"ticket__text",children:[a(n[0].date,0)," - ",a(n[0].date,n[0].duration)]})]}),Object(s.jsxs)("div",{className:"ticket__col",children:[Object(s.jsx)("div",{className:"ticket__title",children:"\u0412 \u043f\u0443\u0442\u0438"}),Object(s.jsx)("div",{className:"ticket__text",children:r(n[0].duration)})]}),Object(s.jsxs)("div",{className:"ticket__col",children:[Object(s.jsx)("div",{className:"ticket__title",children:l(n[0].stops)}),Object(s.jsx)("div",{className:"ticket__text",children:n[0].stops.map((function(t,e,c){return Object(s.jsxs)("span",{children:[++e!==c.length?t+",":t," "]},e)}))})]})]}),Object(s.jsxs)("div",{className:"ticket__row",children:[Object(s.jsxs)("div",{className:"ticket__col",children:[Object(s.jsxs)("div",{className:"ticket__title",children:[n[1].origin," - ",n[1].destination]}),Object(s.jsxs)("div",{className:"ticket__text",children:[a(n[1].date,0)," - ",a(n[1].date,n[1].duration)]})]}),Object(s.jsxs)("div",{className:"ticket__col",children:[Object(s.jsx)("div",{className:"ticket__title",children:"\u0412 \u043f\u0443\u0442\u0438"}),Object(s.jsx)("div",{className:"ticket__text",children:r(n[1].duration)})]}),Object(s.jsxs)("div",{className:"ticket__col",children:[Object(s.jsx)("div",{className:"ticket__title",children:l(n[1].stops)}),Object(s.jsx)("div",{className:"ticket__text",children:n[1].stops.map((function(t,e,c){return Object(s.jsxs)("span",{children:[++e!==c.length?t+",":t," "]},e)}))})]})]})]})}),F=(c(58),function(t){Object(u.a)(c,t);var e=Object(d.a)(c);function c(){return Object(o.a)(this,c),e.apply(this,arguments)}return Object(j.a)(c,[{key:"render",value:function(){var t=this.props,e=t.tickets,c=t.sort,i=t.perPage,n=t.pageCount,a=t.filter;return Object(s.jsx)("div",{className:"tickets",children:e.sort((function(t,e){if("price"===c){if(t.price>e.price)return 1;if(t.price===e.price)return 0;if(t.price<e.price)return-1}else if("duration"===c){if((t=t.segments[0].duration+t.segments[1].duration)>(e=e.segments[0].duration+e.segments[1].duration))return 1;if(t===e)return 0;if(t<e)return-1}return null})).filter((function(t){if(!(a.length>0))return t;for(var e=0;e<a.length;e++)if(t.segments[0].stops.length===+a[e])for(var c=0;c<a.length;c++)if(t.segments[1].stops.length===+a[c])return t;return null})).slice(1,n*i+1).map((function(t,e){return Object(s.jsx)(y,{ticket:t},e)}))})}}]),c}(n.a.Component)),E=Object(l.b)((function(t){return{tickets:t.ticketsReduce.tickets,sort:t.ticketsReduce.sort,perPage:t.ticketsReduce.perPage,pageCount:t.ticketsReduce.pageCount,filter:t.ticketsReduce.filter}}),{})(F),S=(c(59),function(t){Object(u.a)(c,t);var e=Object(d.a)(c);function c(){return Object(o.a)(this,c),e.apply(this,arguments)}return Object(j.a)(c,[{key:"render",value:function(){var t=this.props,e=t.sort,c=t.sorting;return Object(s.jsxs)("div",{className:"tabs",children:[Object(s.jsx)("button",{onClick:function(){return c("price")},className:"tabs__btn ".concat("price"===e&&"_active"),children:"\u0421\u0430\u043c\u044b\u0439 \u0434\u0435\u0448\u0435\u0432\u044b\u0439"}),Object(s.jsx)("button",{onClick:function(){return c("duration")},className:"tabs__btn ".concat("duration"===e&&"_active"),children:"\u0421\u0430\u043c\u044b\u0439 \u0431\u044b\u0441\u0442\u0440\u044b\u0439"})]})}}]),c}(n.a.Component)),T={sorting:function(t){return function(e){e({type:_,sort:t})}}},w=Object(l.b)((function(t){return{sort:t.ticketsReduce.sort}}),T)(S),I=(c(60),c(61),function(){return Object(s.jsx)("div",{className:"Preloader"})}),R=function(t){Object(u.a)(c,t);var e=Object(d.a)(c);function c(){return Object(o.a)(this,c),e.apply(this,arguments)}return Object(j.a)(c,[{key:"componentDidMount",value:function(){var t=this;this.props.setTickets(),window.addEventListener("scroll",(function(){var e=document.documentElement.offsetHeight,c=document.documentElement.clientHeight;document.documentElement.scrollTop+c>e-c&&t.props.nextPage(t.props.pageCount)}))}},{key:"render",value:function(){var t=this.props.isFetching;return Object(s.jsxs)("div",{className:"app",children:[Object(s.jsx)("div",{className:"app__logo",children:Object(s.jsx)(C,{})}),Object(s.jsxs)("div",{className:"app__row",children:[Object(s.jsx)("div",{className:"app__filter",children:Object(s.jsx)(g,{})}),Object(s.jsxs)("div",{className:"app__container",children:[Object(s.jsx)("div",{className:"app__tabs",children:Object(s.jsx)(w,{})}),Object(s.jsx)("div",{className:"app__tickets",children:t?Object(s.jsx)(I,{}):Object(s.jsx)(E,{})})]})]})]})}}]),c}(n.a.Component),P={setTickets:function(){return function(t){var e={};t({type:m,isFetching:!0}),p.a.get("https://front-test.beta.aviasales.ru/search").then((function(t){e=t.data,c()}));var c=function c(){var s=e;p.a.get("https://front-test.beta.aviasales.ru/tickets?searchId=".concat(s.searchId)).then((function(e){e.data.stop?t({type:m,isFetching:!1}):(t({type:h,tickets:e.data.tickets,stop:e.data.stop}),c())})).catch((function(e){c(),t({type:O})}))}}},nextPage:function(t){return function(e){e({type:f,pageCount:t})}}},G=Object(l.b)((function(t){return{isFetching:t.ticketsReduce.isFetching,pageCount:t.ticketsReduce.pageCount}}),P)(R),L=c(9),D=c(26),M=c(16),A=c(3),H={tickets:[],sort:"price",perPage:20,pageCount:1,isFetching:!1,filter:[],failed:!1},J=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case m:return Object(A.a)(Object(A.a)({},t),{},{isFetching:e.isFetching});case h:return Object(A.a)(Object(A.a)({},t),{},{tickets:Object(M.a)(t.tickets).concat(e.tickets)});case O:return Object(A.a)(Object(A.a)({},t),{},{failed:!0});case _:return Object(A.a)(Object(A.a)({},t),{},{sort:e.sort,pageCount:1});case f:return Object(A.a)(Object(A.a)({},t),{},{pageCount:e.pageCount+1});case x:var c=function(e){var c=Object(M.a)(t.filter);return-1!==c.indexOf(e)?c.splice(c.indexOf(e),1):c.push(e),c};return Object(A.a)(Object(A.a)({},t),{},{pageCount:1,filter:c(+e.filter)});default:return t}},K=Object(L.c)({ticketsReduce:J}),W=Object(L.d)(K,Object(L.a)(D.a));r.a.render(Object(s.jsx)(n.a.StrictMode,{children:Object(s.jsx)(l.a,{store:W,children:Object(s.jsx)(G,{})})}),document.getElementById("root"))}},[[62,1,2]]]);
//# sourceMappingURL=main.22bb8177.chunk.js.map